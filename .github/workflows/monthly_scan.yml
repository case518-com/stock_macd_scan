name: æœˆMACDæƒæ - æ¯æœˆ5è™Ÿè‡ªå‹•åŸ·è¡Œ

on:
  schedule:
    # æ¯æœˆ5è™Ÿ å°ç£æ™‚é–“ 09:00ï¼ˆUTC+8 â†’ UTC 01:00ï¼‰
    - cron: '0 1 * * 6'
  # ä¹Ÿå¯ä»¥æ‰‹å‹•åœ¨ GitHub é é¢è§¸ç™¼ï¼Œæ–¹ä¾¿æ¸¬è©¦
  workflow_dispatch:

jobs:
  scan:
    runs-on: ubuntu-latest

    steps:
      - name: å–å‡ºç¨‹å¼ç¢¼
        uses: actions/checkout@v4

      - name: è¨­å®š Python ç’°å¢ƒ
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: å®‰è£å¥—ä»¶
        run: |
          pip install yfinance pandas requests lxml html5lib

      - name: åŸ·è¡Œæƒæ
        run: python scan_monthly.py

      - name: å°‡çµæœå¯«å› GitHub
        run: |
          git config user.name  "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add scan_result.txt
          git diff --cached --quiet || git commit -m "ğŸ“Š $(date +'%Y-%m') æœˆMACDæƒæçµæœ"
          git push
