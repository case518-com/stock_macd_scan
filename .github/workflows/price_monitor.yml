name: ç›¤ä¸­è‚¡åƒ¹ç›£æ§ - æ¯10åˆ†é˜

on:
  schedule:
    # å°ç£æ™‚é–“ 09:00~13:30 = UTC 01:00~05:30ï¼Œæ¯10åˆ†é˜
    - cron: '0,10,20,30,40,50 1,2,3,4,5 * * 1-5'
  workflow_dispatch:

jobs:
  monitor:
    runs-on: ubuntu-latest

    steps:
      - name: å–å‡ºç¨‹å¼ç¢¼
        uses: actions/checkout@v4

      - name: è¨­å®š Python ç’°å¢ƒ
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: å®‰è£å¥—ä»¶
        run: pip install yfinance pandas requests

      - name: åŸ·è¡Œè‚¡åƒ¹ç›£æ§
        run: python monitor.py

      - name: å„²å­˜é€šçŸ¥ç´€éŒ„å› GitHub
        run: |
          git config user.name  "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add alert_log.json
          git diff --cached --quiet || git commit -m "ğŸ“‹ æ›´æ–°è§¸åƒ¹é€šçŸ¥ç´€éŒ„ $(date +'%Y-%m-%d %H:%M')"
          git push
